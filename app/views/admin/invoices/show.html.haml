= render partial: 'admin/invoices/header'

- if @invoice.status == :draft
  .alert.alert-info
    The customer has started this order but has yet to complete it!
.row
  .col-12.col-lg-5
    .card.card-primary
      %h5.card-header.bg-primary.text-white
        = fa_solid 'file-invoice'
        = "Invoice ##{@invoice.identifier} - #{@invoice.status}"
      .card-body
        .form-group.row
          %label.col-form-label.col-6 Customer
          .form-control-plaintext.col
            = link_to @invoice.customer.full_name, admin_customer_path(@invoice.customer)
        .form-group.row
          %label.col-form-label.col-6 Date Created
          .form-control-plaintext.col= lifp(@invoice.created_at, :short)
        .form-group.row
          %label.col-form-label.col-6 Sales Tax
          .form-control-plaintext.col= number_to_currency @invoice.tax_total

  .col-12.col-lg-7
    .card
      %h4.card-header.bg-primary.text-white
        = fa_solid 'list'
        Summary
      %ul.list-group
        - @invoice.items.each do |i|
          %li.list-group-item
            .row
              .col-7.mb-3.mb-md-0
                = render partial: 'item_descriptions/show', locals: {item: i}
              .col-5.text-right
                %span.font-weight-medium
                  = content_tag :span, number_to_currency(i.line_total)
    .card.mt-2
      %h4.card-header.bg-primary.text-white
        = fa_solid 'money-check'
        Payments
      %ul.list-group
        - @invoice.payments.each do |p|
          %li.list-group-item
            .row
              .col-8.mb-3.mb-md-0
                %pre= "Method: #{p.method}\nProcessed on: #{l p.created_at, format: :short}\nTransaction ID: #{p.identifier}"
              .col-4.text-right
                %span.font-weight-medium
                  = content_tag :span, number_to_currency(p.amount)

    .card.mt-2
      %h4.card-header.bg-primary.text-white
        = fa_solid 'gift-card'
        Refunds
      %ul.list-group
        - @invoice.refunds.each do |r|
          %li.list-group-item
            .row
              .col-8.mb-3.mb-md-0
                - if r.customer_credit.present?
                  Credit
                - else
                  BrainTree
              .col-4.text-right
                %span.font-weight-medium
                  = content_tag :span, number_to_currency(r.amount)
