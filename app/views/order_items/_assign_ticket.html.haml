#assign-ticket-modal.modal.fade{"aria-hidden": "true", "aria-labelledby": "exampleModalLabel", role: "dialog", tabindex: "-1"}
  = form_for :order_item, url: '', html: { id: :assign_ticket } do |f|
    .modal-dialog.modal-lg{role: "document"}
      .modal-content
        .modal-header
          %h5.modal-title Assign Seat
          %button.close{"aria-label": "Close", "data-dismiss": "modal", type: "button"}
            %span{"aria-hidden": "true"} Ã—
        .modal-body
          = f.hidden_field :id
          .form-row
            .form-group.col
              %label Workshop
              %input.form-control-plaintext{disabled: true, id: 'order_item_workshop'}
          .form-row
            .form-group.col
              %label Project
              %input.form-control-plaintext{disabled: true, id: 'order_item_description'}
          .form-row
            .form-group.col-6
              %label First Name
              = f.text_field :first_name, class: 'form-control', autofocus: true, autocomplete: 'off'
            .form-group.col-6
              %label Last Name
              = f.text_field :last_name, class: 'form-control', autocomplete: 'off'
          .form-row
            .form-group.col
              %label Email
              = f.text_field :email, class: 'form-control'
        .modal-footer
          %button.btn.btn-secondary{"data-dismiss": "modal", type: "button"} Close
          %button.btn.btn-primary{type: 'submit'} Send Invite

- content_for :scripts do
  :javascript
    $('#assign-ticket-modal').on('show.bs.modal', function (event) {
      var button = $(event.relatedTarget)
      var orderId = button.data('order-id')
      var orderItemId = button.data('order-item-id')
      var modal = $(this)

      var request = new XMLHttpRequest();
      var url = '/orders/' + orderId + '/items/' + orderItemId + '.json'
      request.open('GET', url, true);
      request.onreadystatechange = function() {
        if (this.readyState != 4 || this.status != 200) return;

        var data = JSON.parse(this.response)
        modal.find('.modal-title').text('Assign Seat #' + data.identifier)
        document.getElementById('assign_ticket').action = '/orders/' + orderId + '/items/' + orderItemId + '/assign'
        document.getElementById('order_item_id').value = orderItemId
        document.getElementById('order_item_workshop').value = data.workshop + ' - ' + data.when
        document.getElementById('order_item_description').value = data.description
      };
      request.send();
    });
